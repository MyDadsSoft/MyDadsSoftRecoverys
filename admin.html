<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; color:#333; margin:0; padding:0; }
header { text-align:center; padding:2em; background:#222; color:#fff; }
.card { background:#fff; padding:2em; margin:2em auto; border-radius:10px; max-width:800px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.order { border-bottom:1px solid #ccc; padding:10px 0; }
button { margin:5px; padding:5px 10px; border:none; border-radius:5px; cursor:pointer; }
</style>
</head>
<body>
<header><h1>Admin Dashboard</h1></header>
<section class="card">
  <h2>Orders</h2>
  <div id="orders"></div>
</section>
<script>
async function loadOrders() {
  const res = await fetch('/functions/get-orders');
  return await res.json();
}

async function renderOrders() {
  const orders = await loadOrders();
  const container = document.getElementById('orders');
  container.innerHTML = '';
  orders.forEach(order => {
    const div = document.createElement('div');
    div.className = 'order';
    div.innerHTML = `<strong>ID:</strong> ${order.id}<br>
    <strong>Email:</strong> ${order.email}<br>
    <strong>Discord:</strong> ${order.discord}<br>
    <strong>Platform:</strong> ${order.platform}<br>
    <strong>Package:</strong> ${order.package}<br>
    <strong>Transfer:</strong> ${order.transferMethod}<br>
    <strong>Status:</strong> ${order.status}<br>
    <button onclick="markCompleted('${order.id}')">Mark Completed</button>
    <button onclick="confirmDeleted('${order.id}')">Confirm Credentials Deleted</button>`;
    container.appendChild(div);
  });
}

async function markCompleted(id){
  await fetch('/functions/update-order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id,action:'completed'})});
  renderOrders();
}

async function confirmDeleted(id){
  await fetch('/functions/update-order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id,action:'deleted'})});
  renderOrders();
}

renderOrders();
</script>
</body>
</html>
