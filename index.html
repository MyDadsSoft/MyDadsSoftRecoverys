<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyDadsSoft Recoverys</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #1f1c2c, #928dab);
  color: #fff;
  margin: 0;
  padding: 0;
}
header {
  text-align: center;
  padding: 3em 1em;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(5px);
}
header h1 { margin: 0; font-size: 2.5em; letter-spacing: 1px; }
header p { margin-top: 0.5em; font-weight: 300; }

.card {
  background: rgba(255,255,255,0.1);
  padding: 2em;
  margin: 2em auto;
  border-radius: 15px;
  max-width: 600px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  backdrop-filter: blur(10px);
}

label { display:block; margin:1em 0 0.5em; font-weight: 600; }
input, select {
  width:100%; padding:10px; border-radius:5px; border:none;
  background: rgba(255,255,255,0.2); color: #fff;
}
input::placeholder { color: #ddd; }

button {
  margin-top: 1em;
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  background: #ffb74d;
  color: #222;
  font-weight: bold;
  font-size: 1.1em;
  cursor: pointer;
  transition: 0.3s;
}
button:hover { background: #ffa726; }

#customAmountContainer { display: none; }

h2 { text-align: center; margin-bottom: 1em; }

#status { text-align: center; margin-top: 1em; font-weight: bold; }

.notice {
  background: rgba(255,255,255,0.15);
  padding: 1em;
  margin: 1em 0;
  border-radius: 10px;
  text-align: center;
  font-weight: bold;
  color: #ffeb3b;
}

#customPriceDisplay {
  margin-top: 0.5em;
  font-weight: bold;
  color: #ffeb3b;
  text-align: center;
}
</style>
</head>
<body>

<header>
  <h1>MyDadsSoft Recoverys</h1>
  <p>GTA V Account Boosting & Safe Recoveries Since 2013</p>
</header>

<section class="card">
  <h2>Order a Boost / Recovery</h2>

  <div class="notice">
    Recoveries are <strong>ONLY allowed</strong> on <strong>Rockstar Games Launcher</strong> accounts. <br>
    Steam and Epic accounts are <strong>NOT allowed</strong>.
  </div>

  <form id="orderForm">
    <label>Email <input type="email" id="email" placeholder="customer@example.com" required></label>
    <label>Discord <input type="text" id="discord" placeholder="username#0001" required></label>
    <label>Platform
      <select id="platform">
        <option>PC</option>
      </select>
    </label>
    <label>Package
      <select id="pkg">
        <option value="5">10 Million — £5</option>
        <option value="15">50 Million — £15</option>
        <option value="25">100 Million — £25</option>
        <option value="custom">Custom Amount</option>
      </select>
    </label>
    <label id="customAmountContainer">Custom Amount (Million) <input type="number" id="customAmount" min="1"></label>
    <div id="customPriceDisplay"></div>
    <label>Transfer Method
      <select id="transferMethod">
        <option value="screenshare">Screen-share</option>
        <option value="onetimelink">One-time URL</option>
        <option value="discord_dm">Discord DM</option>
      </select>
    </label>
    <button type="submit">Pay with PayPal (F&F)</button>
  </form>
  <div id="status"></div>
</section>

<script>
// Price per million
const pricePerMillion = 0.5; // £0.5 per million

// Show custom amount field
const pkgSelect = document.getElementById('pkg');
const customC = document.getElementById('customAmountContainer');
const customPriceDisplay = document.getElementById('customPriceDisplay');
const customAmountInput = document.getElementById('customAmount');

pkgSelect.addEventListener('change', () => {
  if(pkgSelect.value === 'custom') {
    customC.style.display = 'block';
    customPriceDisplay.textContent = '';
  } else {
    customC.style.display = 'none';
    customPriceDisplay.textContent = '';
  }
});

customAmountInput.addEventListener('input', () => {
  const amount = Number(customAmountInput.value);
  if(amount > 0) {
    const price = (amount * pricePerMillion).toFixed(2);
    customPriceDisplay.textContent = `Price: £${price}`;
  } else {
    customPriceDisplay.textContent = '';
  }
});

// Generate unique ID
function generateOrderId() {
  return `ORD-${Date.now().toString(36)}-${Math.random().toString(36).substring(2,6)}`;
}

// Submit order
document.getElementById('orderForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const id = generateOrderId();
  const email = document.getElementById('email').value;
  const discord = document.getElementById('discord').value;
  const platform = document.getElementById('platform').value;
  const pkg = pkgSelect.value === 'custom' ? customAmountInput.value : pkgSelect.value;
  const transferMethod = document.getElementById('transferMethod').value;

  if(!pkg || Number(pkg) <= 0){
    document.getElementById('status').textContent = 'Please enter a valid amount!';
    document.getElementById('status').style.color = '#ff5252';
    return;
  }

  try {
    const res = await fetch('/functions/log-order', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ id, email, discord, platform, pkg, transferMethod, status:'pending' })
    });

    const data = await res.json();
    const statusDiv = document.getElementById('status');

    if(data.success){
      statusDiv.textContent = `Order logged! Redirecting to PayPal...`;
      statusDiv.style.color = '#4caf50';

      // Calculate price
      const price = (Number(pkg) * pricePerMillion).toFixed(2);

      // Redirect to PayPal.me F&F
      const paypalLink = `https://paypal.me/MyDadsSoft/${price}`;
      window.open(paypalLink, '_blank');
    } else {
      statusDiv.textContent = `Error: ${data.error}`;
      statusDiv.style.color = '#ff5252';
    }
  } catch(err){
    document.getElementById('status').textContent = 'Failed to log order.';
    document.getElementById('status').style.color = '#ff5252';
    console.error(err);
  }
});
</script>

</body>
</html>
